---
import { getCollection } from "astro:content"
const posts = await getCollection("reviews")
---

<div class="container my-16 reviews">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="col-span-1 flex flex-col justify-between">
            <div class="relative">
                <p class="m-0">Du wirst begeistert sein</p>
                <h2 class="font-baloo text-bigger leading-none">Das sagen<br/>unsere GÃ¤ste!</h2>
            </div>

            <div class="controls mt-16">
                <div class="flex items-center gap-3">
                    <span class="rounded-full p-4 bg-white cursor-pointer swiper-prev">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                            <path fill-rule="evenodd" d="M20.25 12a.75.75 0 01-.75.75H6.31l5.47 5.47a.75.75 0 11-1.06 1.06l-6.75-6.75a.75.75 0 010-1.06l6.75-6.75a.75.75 0 111.06 1.06l-5.47 5.47H19.5a.75.75 0 01.75.75z" clip-rule="evenodd" />
                        </svg>
                    </span>
                    <span class="rounded-full p-4 bg-white cursor-pointer swiper-next">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                            <path fill-rule="evenodd" d="M3.75 12a.75.75 0 01.75-.75h13.19l-5.47-5.47a.75.75 0 011.06-1.06l6.75 6.75a.75.75 0 010 1.06l-6.75 6.75a.75.75 0 11-1.06-1.06l5.47-5.47H4.5a.75.75 0 01-.75-.75z" clip-rule="evenodd" />
                        </svg>
                    </span>
                </div>
            </div>
        </div>
        <div class="md:col-span-2">
            <div class="swiper overflow-hidden">
                <div class="swiper-wrapper relative">
                    {posts.map(({data}, idx) => {
                        return (
                            <div class="swiper-slide" key={idx}>
                                <div class="p-4 rounded-xl bg-light">
                                    <div class="flex flex-col mb-6">
                                        <p class="font-medium text-sm">{data.name}</p>    
                                        <p class="text-sm text-neutral-400">{new Date(data.date).toLocaleDateString()}</p>    
                                    </div>
                                    <svg width="56" height="37" viewBox="0 0 56 37" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M31.2941 24.7166C31.2941 22.2699 31.5686 19.6235 32.1176 16.7773C32.6667 13.8812 33.4902 11.2099 34.5882 8.76316C35.7362 6.26653 37.1586 4.19433 38.8556 2.54656C40.5526 0.848853 42.574 0 44.9198 0C45.7683 0 46.5668 0.299595 47.3155 0.898785C48.1141 1.49798 48.5134 2.44669 48.5134 3.74494V4.34413C48.4635 4.89339 48.3137 5.41768 48.0642 5.917C47.8146 6.41633 47.5401 6.91565 47.2406 7.41498C46.9412 7.91431 46.6667 8.4386 46.4171 8.98785C46.2175 9.48718 46.1176 9.9865 46.1176 10.4858C46.1176 11.0351 46.3672 11.4845 46.8663 11.834C47.3654 12.1835 47.9644 12.558 48.6631 12.9575C49.4118 13.357 50.2103 13.8313 51.0588 14.3806C51.9073 14.8799 52.6809 15.5789 53.3797 16.4777C54.1283 17.3266 54.7522 18.4251 55.2513 19.7733C55.7504 21.0715 56 22.7193 56 24.7166C56 29.0108 54.9269 32.1316 52.7808 34.0789C50.6346 36.0263 47.5651 37 43.5722 37C39.4296 37 36.3351 36.0263 34.2888 34.0789C32.2923 32.1316 31.2941 29.0108 31.2941 24.7166ZM0 24.7166C0 22.2699 0.27451 19.6235 0.823529 16.7773C1.37255 13.8812 2.19608 11.2099 3.29412 8.76316C4.44207 6.26653 5.86453 4.19433 7.5615 2.54656C9.25847 0.848853 11.2799 0 13.6257 0C14.4742 0 15.2727 0.299595 16.0214 0.898785C16.82 1.49798 17.2193 2.44669 17.2193 3.74494V4.34413C17.1693 4.89339 17.0196 5.41768 16.7701 5.917C16.5205 6.41633 16.246 6.91565 15.9465 7.41498C15.6471 7.91431 15.3725 8.4386 15.123 8.98785C14.9234 9.48718 14.8235 9.9865 14.8235 10.4858C14.8235 11.0351 15.0731 11.4845 15.5722 11.834C16.0713 12.1835 16.6702 12.558 17.369 12.9575C18.1176 13.357 18.9162 13.8313 19.7647 14.3806C20.6132 14.8799 21.3868 15.5789 22.0856 16.4777C22.8342 17.3266 23.4581 18.4251 23.9572 19.7733C24.4563 21.0715 24.7059 22.7193 24.7059 24.7166C24.7059 29.0108 23.6328 32.1316 21.4866 34.0789C19.3405 36.0263 16.2709 37 12.2781 37C8.13547 37 5.041 36.0263 2.99465 34.0789C0.998218 32.1316 0 29.0108 0 24.7166Z" fill="#EBE9DD"/>
                                    </svg>
                                    <div class="mt-6">{data.content}</div>
                                </div>
                            </div>
                        )
                    })}
                    
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // core version + navigation, pagination modules:
    import Swiper from 'swiper';
    import { Autoplay, Navigation, Pagination } from 'swiper/modules';

    Swiper.use([Autoplay, Navigation, Pagination]);
    // import Swiper and modules styles
    import 'swiper/css';
    import 'swiper/css/navigation';
    import 'swiper/css/pagination';

    const wrapper = document.querySelector(".reviews");
    const element = wrapper.querySelector(".swiper");
  
    const options = {
        autoHeight: false,
        slidesPerView: 2,
        spaceBetween: 16,
        autoplay: {
            delay: 5000
        },
        speed: 600,
        effect: "slide",
    };

    options["navigation"] = {
        nextEl: wrapper.querySelector(".swiper-next"),
        prevEl: wrapper.querySelector(".swiper-prev"),
    };

    options["breakpoints"] = {
        320: {
            slidesPerView: 1,
            spaceBetween: 16,
        },
        // when window width is >= 480px
        480: {
            slidesPerView: 2,
            spaceBetween: 16,
        },
        // when window width is >= 640px
        640: {
            slidesPerView: 2,
            spaceBetween: 16,
        },
        1024: {
            slidesPerView: 2,
            spaceBetween: 16,
        },
    };

    const swiper = new Swiper(element, options);
</script>